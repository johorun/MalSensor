import os
import subprocess


gexf_dir = '/home/zhj/data2/20230929/MalwareDrift/gexf/'
gexf_list = os.listdir(gexf_dir)
gexf_num = len(gexf_list)
print(gexf_num)
filehash = []
hashname = {}
with open('/home/zhj/data2/MalwareBazaar/Benchmarking-Malware-Family-Classification/Datasets/MalwareDrift_Labels.csv','r') as f:
	for line in f:
		hashname.setdefault(line.split(',')[0],line.split(',')[3].strip())


for file in gexf_list:
	gexfname = gexf_dir + file
	if hashname[file.split('.')[0]] == 'post-drift':
		subprocess.getstatusoutput('mv %s /home/zhj/data2/20230929/MalwareDrift/gexf_post/' % gexfname)

	if hashname[file.split('.')[0]] == 'pre-drift':
		subprocess.getstatusoutput('mv %s /home/zhj/data2/20230929/MalwareDrift/gexf_pre/' % gexfname)